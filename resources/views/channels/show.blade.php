@extends('layouts.app')

@section('content')
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between">
                        {{ $channel->name }}
                        <a href="{{ route('channelUpload',$channel->id) }}">视频上传</a>
                    </div>

                    <div class="card-body">
                        @if($channel->editable())
                        <form method="post" id="update-channel-form"  action="{{ route('channels.update',$channel->id) }}"
                              enctype="multipart/form-data">
                            @csrf
                            @method('PATCH')
                        @endif
                            <div class="form-group row justify-content-center">
                                <div  class="channel-avatar">
                                    @if($channel->editable())
                                    <div class="channel-avatar-overlay" onclick="document.getElementById('image').click()">
                                        <svg t="1596677349067" class="icon" viewBox="0 0 1197 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7179" width="56.109375" height="48" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M184.781955 456.565414c-4.234586-4.234586-10.009023-6.544361-15.783459-6.544361-5.774436 0-11.548872 2.309774-15.783458 6.544361-4.234586 4.234586-6.544361 10.009023-6.544361 15.783458 0 5.774436 2.309774 11.548872 6.544361 15.783459 4.234586 4.234586 10.009023 6.544361 15.783458 6.544361 5.774436 0 11.548872-2.309774 15.783459-6.544361 4.234586-4.234586 6.544361-10.009023 6.544361-15.783459 0-6.159398-2.309774-11.933835-6.544361-15.783458z m0 0M168.998496 527.013534c-12.318797 0-22.32782 10.009023-22.327819 22.327819v141.281203c0 12.318797 10.009023 22.32782 22.327819 22.32782 12.318797 0 22.32782-10.009023 22.32782-22.32782v-141.281203c0-12.703759-10.009023-22.32782-22.32782-22.327819z m0 0M768.769925 381.497744c-102.784962 0-186.321805 83.536842-186.321805 186.321805s83.536842 186.321805 186.321805 186.321804 186.321805-83.536842 186.321804-186.321804-83.536842-186.321805-186.321804-186.321805z m0 327.98797c-78.147368 0-141.666165-63.518797-141.666166-141.666165 0-78.147368 63.518797-141.666165 141.666166-141.666166 78.147368 0 141.666165 63.518797 141.666165 141.666166 0 78.147368-63.518797 141.666165-141.666165 141.666165z m0 0" fill="#ffffff" p-id="7180"></path><path d="M837.678195 478.893233l-1.154887-1.154887c-9.62406-7.314286-23.867669-5.389474-31.181955 4.234586-7.314286 9.62406-5.389474 23.867669 4.234587 31.181955l0.769925 0.769925c4.234586 3.079699 8.854135 4.619549 13.473684 4.619549 6.544361 0 13.088722-3.079699 17.708271-8.469173 7.314286-9.62406 5.774436-23.482707-3.849625-31.181955z m0 0M858.851128 545.491729c-12.318797 0-22.32782 10.009023-22.32782 22.32782 0 37.341353-30.41203 67.753383-67.753383 67.753383-37.341353 0-67.753383-30.41203-67.753384-67.753383 0-12.318797-10.009023-22.32782-22.327819-22.32782-12.318797 0-22.32782 10.009023-22.32782 22.32782 0 61.978947 50.430075 112.02406 112.02406 112.02406s112.02406-50.430075 112.024061-112.02406c0.384962-12.318797-9.239098-22.32782-21.557895-22.32782z m0 0" fill="#ffffff" p-id="7181"></path><path d="M1141.413534 190.171429H1042.863158l-59.284211-108.559399c-3.849624-7.314286-11.548872-11.548872-19.633082-11.548872h-135.121805c-12.318797 0-22.32782 10.009023-22.327819 22.327819s10.009023 22.32782 22.327819 22.32782H950.857143l95.470677 175.542857H473.503759l95.470677-175.542857h121.64812c12.318797 0 22.32782-10.009023 22.32782-22.32782s-10.009023-22.32782-22.32782-22.327819h-134.736842c-8.084211 0-15.783459 4.619549-19.633082 11.548872L477.353383 190.556391H49.275188C36.956391 190.171429 26.947368 200.180451 26.947368 212.499248v710.255639c0 12.318797 10.009023 22.32782 22.32782 22.32782h1092.138346c12.318797 0 22.32782-10.009023 22.327819-22.32782V212.499248c-0.384962-12.318797-10.009023-22.32782-22.327819-22.327819zM618.249624 334.532331c-70.44812 45.810526-119.338346 122.418045-126.267669 210.959398h-47.735338c-12.318797 0-22.32782 10.009023-22.32782 22.32782 0 12.318797 10.009023 22.32782 22.32782 22.327819h47.735338c6.929323 88.541353 55.434586 165.148872 126.267669 210.959399h-311.819549V334.532331h311.819549z m150.520301 0c128.577444 0 232.902256 104.709774 232.902255 232.902255 0 128.577444-104.709774 232.902256-232.902255 232.902256s-232.902256-104.709774-232.902256-232.902256 104.324812-232.902256 232.902256-232.902255zM71.603008 234.827068h381.882706l-30.41203 55.434586H71.603008V234.827068z m0 99.705263h190.941353V800.721805H71.603008V334.532331z m1047.482706 565.894737H71.603008v-55.434587h1047.867669v55.434587z m0-99.705263h-199.795488c76.222556-49.66015 127.037594-135.506767 127.037594-232.902256 0-97.780451-50.815038-183.627068-127.037594-232.902256h199.795488v465.804512z m0-510.460151H1097.142857L1066.730827 234.827068h52.354887v55.434586z m0 0" fill="#ffffff" p-id="7182"></path><path d="M761.070677 70.44812h-1.154888c-12.318797 0-22.32782 10.009023-22.327819 22.32782s10.009023 22.32782 22.327819 22.327819h1.154888c12.318797 0 22.32782-10.009023 22.327819-22.327819s-10.009023-22.32782-22.327819-22.32782z m0 0" fill="#ffffff" p-id="7183"></path></svg>
                                    </div>
                                    @endif
                                    <img src="{{ $channel->image() }}">
                                </div>
                            </div>
                            <subscription-button :channel="{{ $channel }}" :subscriptions = "{{ $channel->subscriptions }}" inline-template>
                                <div class="text-center mt-3 mb-1">
                                    <button @click="toggleSubscription" class="btn btn-danger">
                                        @{{owner ? '' : subscribed ? "取消订阅" :"订阅" }} @{{ count }} @{{ owner ? '个订阅者' :'' }}
                                    </button>
                                </div>
                            </subscription-button>
                            @if(!$channel->editable())
                                <div class="form-group">
                                        <h4 class="text-center">{{ $channel->name }}</h4>
                                        <p class='text-center'>
                                            {{ $channel->description }}
                                        </p>
                                </div>
                            @endif
                             @if($channel->editable())
                            <input style="display: none" onchange="document.getElementById('update-channel-form').submit()" name="image" id="image" type="file">
                            <div class="form-group">
                                <label for="name" class="form-control-label">
                                    频道名
                                </label>
                                <input id="name" type="text" value="{{ $channel->name }}" class="form-control"
                                       name="name">
                            </div>
                            <div class="form-group">
                                <label for="description" class="form-control-label">
                                    频道描述
                                </label>
                                <textarea name="description" id="description" class="form-control">
                                    {{$channel->description}}
                                </textarea>
                            </div>
                            @if($errors->any())
                                <ul class="'list-group mb-5">
                                    @foreach($errors->all() as $error)
                                        <li class="text-danger list-group-item">
                                            {{ $error }}
                                        </li>
                                    @endforeach
                                </ul>
                            @endif
                                <button class="btn btn-info" type="submit">
                                    保存
                                </button>
                        </form>
                       @endif
                    </div>
                </div>
            </div>
        </div>
    </div>
@endsection
